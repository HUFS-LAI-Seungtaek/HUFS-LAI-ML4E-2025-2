# MNIST 분류 실험 결과

## 기본 모델 성능
- 최종 테스트 정확도: 96.83%
- 훈련 시간: 53초

## 실험 결과
### 실험 1: 하이퍼파라미터 튜닝
- 변경사항: epoch 수를 기존 3에서 4, 5로 각각 늘리고 10회씩 실행한 후 두 실험의 결과를 비교함.

- 결과
1) epoch = 4일 때, 10회 실행 후 각 결과의 평균
[평균 결과]
▶ 평균 훈련 시간: 61.46초
▶ 평균 최종 훈련 정확도: 97.66%
▶ 평균 최종 테스트 정확도: 97.30%
▶ 평균 최종 훈련 Loss: 0.0790
▶ 평균 과적합 수치 (훈련-테스트): 0.35%

2) epoch = 5일 때
[평균 결과]
▶ 평균 훈련 시간: 77.69 초
▶ 평균 최종 훈련 정확도: 98.06%
▶ 평균 최종 테스트 정확도: 97.44%
▶ 평균 최종 훈련 Loss: 0.0640
▶ 평균 과적합 수치 (훈련-테스트): 0.61%


추가/참고 : epoch을 4회와 5회만 집중적으로 실행한 이유
처음 실험을 시작할 때에는 epoch 수치를 3,4,5,6...등 다양하게 실행함. 
초기엔 1회씩 수행한 결과라 수치가 정확하지는 않겠으나, epoch의 증가에 따른 간단한 경향성을 파악하기 위함.

epoch을 6으로 설정하고 1회 실행 결과
- 훈련 시간 : 93초
- 최종 훈련 정확도: 98.44%
- 최종 테스트 정확도: 97.57%
- 최종 훈련 Loss: 0.0510
- 과적합 정도: 0.87% (훈련-테스트 정확도 차이)

epoch을 10으로 설정 후 1회 실행하였을 때의 결과
- 훈련 시간 : 98초
- 최종 훈련 정확도 : 99.25%
- 최종 테스트 정확도 : 97.71%
- loss : 0.0246
- 과적합 : 1.54%


- 분석
: epoch 수를 4회, 5회, 6회로 늘릴수록 훈련 정확도는 높아지는 모습을 확인할 수 있으나, 최종 테스트 정확도에서는 epoch이 4일 때와 10일 때가 약 0.4%p밖에 차이나지 않음. 이 때문에 오히려 epoch이 늘어날수록 과적합 비율만 높아지고 있고, 훈련 시간이 늘어나는 문제점이 발생. 실행 결과 중, 훈련 과정을 시각화한 그래프를 참고하여 최적의 epoch 수를 파악하기 위해 그래프에서 최종 훈련 정확도와 최종 테스트 정확도의 차이가 가장 적게 나타나는 구간이었던 epoch 4와 5를 각각 10회씩 실행하여 정밀분석을 진행함. 
epoch 수가 4회인 경우 평균 최종 훈련 정확도는 97.66%, 평균 최종 테스트 정확도는 97.30%였고, epoch 수가 5회인 경우 평균 최종 훈련 정확도는 98.06%, 평균 최종 테스트 정확도는 97.44%로 나타남. 두 가지 경우에서 평균 최종 테스트 정확도는 0.22%p밖에 차이가 나지 않았고, 평균 최종 훈련 정확도 역시 0.4%p로 미세한 차이를 보임. 과적합 수치 역시 약 0.3%p정도로 미묘한 차이를 보였고, 이 정도의 수치는 약 15초 이상의 시간을 추가로 투자할만큼 가치가 있다고 생각되지 않았고, 또한 모델의 성능에 아주 큰 영향을 준다고 볼 수 없었음. 따라서 epoch의 수가 4회인 경우가 소요 시간과 loss, 과적합, 정확도 측면에서 가장 적합하다고 판단함.


### 실험 2: 모델 구조 개선
- 변경사항: 은닉층 개수를 2개, 3개로 늘려 10회씩 실행 후 모델의 성능 변화 파악
- 결과
*초기값 : 은닉층 개수 1개
[평균 결과]
▶ 평균 훈련 시간: 53.54 초
▶ 평균 최종 훈련 정확도: 96.98%
▶ 평균 최종 테스트 정확도: 96.97%
▶ 평균 최종 훈련 Loss: 0.1023
▶ 평균 과적합 수치 (훈련-테스트): 0.01%

1) 은닉층 개수를 2개로 늘린 경우
[평균 결과]
▶ 평균 훈련 시간: 54.39 초
▶ 평균 최종 훈련 정확도: 96.91%
▶ 평균 최종 테스트 정확도: 96.73%
▶ 평균 최종 훈련 Loss: 0.1024
▶ 평균 과적합 수치 (훈련-테스트): 0.18%

2) 은닉층 개수를 3개로 늘린 경우
[평균 결과]
▶ 평균 훈련 시간: 53.21 초
▶ 평균 최종 훈련 정확도: 96.71%
▶ 평균 최종 테스트 정확도: 96.69%
▶ 평균 최종 훈련 Loss: 0.1070
▶ 평균 과적합 수치 (훈련-테스트): 0.02%

- 분석
: 은닉층 개수를 늘릴수록 정확도가 높아지고 성능이 개선될 것이라고 예상했던 것과 달리, 은닉층의 개수가 1개였던 초기값과 최종 훈련 정확도와 최종 테스트 정확도가 큰 차이가 나지 않았고, 과적합 수치 역시 유의미한 차이가 나타났다고 볼 수 없었음.
이러한 문제를 보완하고자 실험1에서 epoch의 수를 조절하였던 것을 참고하여 은닉층 개수를 늘리면서 epoch의 수 역시 5개로 늘려 추가 실험을 진행함.

1) 은닉층 개수를 2개로 늘리고 epoch 5로 설정
[평균 결과]
▶ 평균 훈련 시간: 89.14 초
▶ 평균 최종 훈련 정확도: 98.03%
▶ 평균 최종 테스트 정확도: 97.34%
▶ 평균 최종 훈련 Loss: 0.0631
▶ 평균 과적합 수치 (훈련-테스트): 0.69%

2) 은닉층 개수를 3개로 늘리고 epoch 5로 설정
[평균 결과]
▶ 평균 훈련 시간: 90.06 초
▶ 평균 최종 훈련 정확도: 97.86%
▶ 평균 최종 테스트 정확도: 97.23%
▶ 평균 최종 훈련 Loss: 0.0684
▶ 평균 과적합 수치 (훈련-테스트): 0.62%

- 분석
: epoch 수를 늘린 결과 훈련 시간은 증가했지만 최종 훈련 정확도와 최종 테스트 정확도가 눈에 띄게 증가했음을 확인할 수 있음. 그러나 은닉층 개수가 2개일 때와 3개일 때의 정확도와 과적합 수치가 큰 차이가 나지 않음. 은닉층 개수가 증가한다고 해서 성능이 유의미하게 좋아진다고 할 수는 없어보임. 여러 원인이 있겠지만, 은닉층의 개수를 늘린만큼 epoch 수를 10회 이상과 같은 확실히 큰 수치로 높여서 훈련을 해야 하거나, 이미 97%에 육박하는 정확도로 인해 더 이상 향상시키는 것이 무의미하기 때문으로 추측됨.


## 결론 및 인사이트
- 가장 효과적인 개선 방법
: 실험1과 실험2의 결과를 보아 성능을 향상시키는 것에서 은닉층의 개수를 늘리고 epoch 수를 늘리는 것이 가장 효과적인 개선 방법이라고 할 수 있음.

- 관찰된 패턴
: 실험 1에서 epoch의 수를 늘릴수록 최종 훈련 정확도 수치가 높아지는 것을 확인할 수 있으나, 최종 테스트 정확도는 함께 높아지지 않아 과적합 수치가 높아지는 현상을 볼 수 있음. 
또한, 실험 2에서 은닉층의 개수를 2개나 3개로 증가하는 것은 유의미한 차이를 보이지 않았고, 은닉층을 증가한 상태에서 epoch의 수를 증가하는 것은 정확도 측면에서 개선된 모습을 볼 수는 있었지만, 같은 epoch 수를 두고 비교했을 때에는 성능 개선이 보이지 않았음.

- 추가 개선 아이디어
: 은닉층의 수를 늘린다고 성능이 유의미하게 향상되지 않았다는 것이 아쉬운데, 이를 개선하기 위해서는 위에서 언급했던 것과 같이 epoch의 수를 아예 큰 수로 바꾸어 훈련을 시키거나, dropout을 추가해볼 수 있을 것 같음. 이번 실험에서는 learning rate를 아예 바꾸지 않았는데, 이 또한 조절해보는 방법도 있을 듯함.